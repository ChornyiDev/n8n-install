# 🛠️ n8n Secure Installer

Цей скрипт автоматизує встановлення [n8n](https://n8n.io) як **systemd-служби** на Linux-сервері, із запуском від **окремого системного користувача `n8n`** для підвищеної безпеки.

---

## ⚙️ Що робить скрипт

* Перевіряє наявність Node.js (допустимі версії: **v18–v22**)
* Встановлює Node.js 18.x, якщо потрібно
* Встановлює `n8n` глобально через `npm`
* Створює системного користувача `n8n`
* Генерує `.env` файл у `/home/n8n/.n8n/.env`
* Створює systemd-службу `n8n.service`
* Запускає службу та вмикає автозапуск при старті системи

---

## 📦 Як використати

```bash
# 1. Клонувати репозиторій
git clone https://github.com/ChornyiDev/n8n-install.git ~/n8n-install

# 2. Перейти в директорію
cd ~/n8n-install

# 3. Запустити скрипт як root або через sudo
sudo bash install-n8n.sh
```

> ⚠️ Скрипт **потрібно запускати з root-правами**, оскільки він створює користувача, встановлює пакети та налаштовує службу.

---

## ✅ Після встановлення

* n8n буде запущено як **системна служба**
* Працює під користувачем `n8n`
* Файл конфігурації:
  `/home/n8n/.n8n/.env`
* Файл системної служби:
  `/home/n8n/.n8n/.env`

---

## 🔧 Команди для керування службою

```bash
# Перевірити статус
sudo systemctl status n8n

# Перезапустити службу
sudo systemctl restart n8n

# Зупинити службу
sudo systemctl stop n8n

# Увімкнути автозапуск
sudo systemctl enable n8n

# Вимкнути автозапуск
sudo systemctl disable n8n

# Перегляд логів у реальному часі
sudo journalctl -u n8n -f

# Змінити конфігурацію
nano /home/n8n/.n8n/.env
```

---

## 🌐 Доступ

Після запуску n8n буде доступний за адресою:

```
http://your-ip:5678
```

> Якщо ви використовуєте reverse proxy або змінюєте конфігурацію — оновіть `.env`.

---

## 📅 Оновлення n8n

У репозиторії є окремий скрипт [`update-n8n.sh`](./update-n8n.sh), що:

- перевіряє поточну версію n8n
- оновлює через `npm`
- перезапускає службу тільки якщо версія змінилась

### 🔧 Ручний запуск

```bash
sudo bash update-n8n.sh
```

### 🕛 Автооновлення (optionally)

Щоб налаштувати автооновлення кожної неділі о 12:00 через Crontab:

```bash
(crontab -l 2>/dev/null; echo "0 12 * * 0 /full/path/to/update-n8n.sh 2>> /var/log/n8n-update.log") | crontab -
```

> Увага: лог записує тільки помилки (stderr) у `/var/log/n8n-update.log`

---

## 📁 Структура

```
~/n8n-install/
├── install-n8n.sh     # головний скрипт встановлення
├── update-n8n.sh      # скрипт для оновлення
├── example.env        # приклад конфігурації
├── README.md          # інструкція
└── nginx/            
    └── n8n.conf      # початкова конфігурація для nginx
```

---

## 📜 Ліцензія

MIT — використовуй, змінюй, поширюй.
